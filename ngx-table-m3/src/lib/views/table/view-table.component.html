<table [cellPadding]="0" [cellSpacing]="0" [width]="'100%'" [border]="0">
    <!-- HEADER -->

    <thead
        [style.color]="viewConfig.headerTextColor"
        [style.background-color]="viewConfig.headerBackgroundColor"
        [style.position]="viewConfig.stickyView?.headerTop ? 'sticky' : 'static'"
        [style.top]="viewConfig.stickyView?.headerTop?.desktopView || undefined"
    >
        <!-- ACTIVE FILTERS -->
        @if (activeFilters.length > 0) {
        <tr>
            <!-- ICON -->
            @if (hasIcon) {
            <th class="active-filters" [style.border-color]="viewConfig.borderColor"></th>
            }

            <!-- TOOLBAR -->
            <th
                class="active-filters"
                [colSpan]="ngxTable.columns.length + (this.hasAction ? 1 : 0)"
                [style.border-color]="viewConfig.borderColor"
            >
                <div class="container" [@toolbar]>
                    <div class="items">
                        @for (item of activeFilters; track $index) {
                        <div class="item" [style.border-color]="viewConfig.borderColor">
                            <div class="title" (click)="updateFilter(item.id)">{{ item.title }}:</div>
                            <div
                                class="value"
                                (click)="updateFilter(item.id)"
                                [ngClass]="item.english ? viewConfig.enClass : ''"
                            >
                                {{ item.value }}
                            </div>
                            <div class="icon" (click)="clearFilter(item.id)">
                                <mat-icon>close</mat-icon>
                            </div>
                        </div>
                        }
                    </div>

                    <!-- CLEAR ALL -->
                    @if (activeFilters.length > 2) {
                    <div
                        class="clear"
                        [style.border-color]="viewConfig.highlight"
                        [style.color]="viewConfig.highlight"
                        [style.background-color]="viewConfig.highlightBackground"
                        (click)="filterCleared.next()"
                    >
                        <div class="title">لغو همه</div>
                        <mat-icon>filter_alt_off</mat-icon>
                    </div>
                    }
                </div>
            </th>
        </tr>
        }

        <tr>
            <!-- ICON -->
            @if (hasIcon) {
            <th></th>
            }

            <!-- COLUMNS -->
            @for (column of ngxTable.columns; track $index) {
            <th [style.text-align]="(column.textAlign || 'RIGHT').toLowerCase()">
                <div class="column">
                    <div class="title">{{ column.title }}</div>

                    <!-- ORDER -->
                    @if (column.tools && orders[column.tools.id]) {
                    <mat-icon
                        (click)="updateOrder(column.tools.id)"
                        [style.cursor]="
                            orders[column.tools.id].type === 'ORDER' || !orders[column.tools.id].current
                                ? 'pointer'
                                : 'default'
                        "
                    >
                        {{
                            orders[column.tools.id].current === 'ASC'
                                ? 'north'
                                : orders[column.tools.id].current === 'DESC'
                                ? 'south'
                                : 'swap_vert'
                        }}
                    </mat-icon>
                    }

                    <!-- FILTER -->
                    @if (column.tools && filters[column.tools.id]) {
                    <mat-icon [style.cursor]="'pointer'" (click)="updateFilter(column.tools.id)">filter_alt</mat-icon>
                    }
                </div>
            </th>
            }

            <!-- ACTION -->
            @if (hasAction) {
            <th></th>
            }
        </tr>
    </thead>

    <!-- BODY -->
    <tbody>
        @for (item of data; track $index; let dataIndex = $index) {
        <tr [style.color]="colors[dataIndex]">
            <!-- ICON -->
            @if (hasIcon) {
            <td class="icon" [style.border-color]="viewConfig.alternateRows ? '' : viewConfig.borderColor">
                <mat-icon [style.color]="icons[$index].color" [style.font-size]="viewConfig.iconSize">
                    {{ icons[$index].icon }}
                </mat-icon>
            </td>
            }

            <!-- DATA -->
            @for (column of ngxTable.columns; track $index; let columnIndex = $index) {
            <td [style.border-color]="viewConfig.alternateRows ? '' : viewConfig.borderColor">
                <view-value
                    [column]="column"
                    [item]="item"
                    [viewConfig]="viewConfig"
                    [isDeactive]="columnIndex === titleIndex && deactives.includes(dataIndex)"
                ></view-value>
            </td>
            }

            <!-- ACTION -->
            @if (hasAction) {
            <td class="action" [style.border-color]="viewConfig.alternateRows ? '' : viewConfig.borderColor">
                <view-action
                    [actions]="ngxTable.actions || []"
                    [item]="item"
                    [viewConfig]="viewConfig"
                    [isMobile]="false"
                ></view-action>
            </td>
            }
        </tr>
        }
    </tbody>
</table>
