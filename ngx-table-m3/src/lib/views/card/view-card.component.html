<!-- TOOLBAR -->
@if (hasToolbar) {
<view-card-toolbar
    [orders]="orders"
    [filters]="filters"
    [viewConfig]="viewConfig"
    (orderChanged)="orderChanged.next($event)"
    (updateFilter)="updateFilter($event)"
    (clearFilter)="filterCleared.next()"
></view-card-toolbar>
}

<!-- DATA -->
<div class="data">
    @for (item of data; track $index; let dataIndex = $index) {
    <section [style.border-color]="viewConfig.borderColor">
        <header
            [style.border-color]="viewConfig.borderColor"
            [style.background-color]="viewConfig.headerBackgroundColor"
            [style.position]="viewConfig.stickyView?.headerTop ? 'sticky' : 'static'"
            [style.top]="headerTop"
        >
            <!-- ICON -->
            @if (hasIcon) {
            <mat-icon [style.color]="icons[$index].color" [style.font-size]="viewConfig.iconSize">
                {{ icons[$index].icon }}
            </mat-icon>
            }

            <!-- TITLE -->
            <div class="title" [style.color]="viewConfig.headerTextColor">
                <view-value
                    [column]="ngxTable.columns[this.titleIndex]"
                    [item]="item"
                    [viewConfig]="viewConfig"
                    [isDeactive]="deactives.includes(dataIndex)"
                    [isCard]="true"
                    [isCardTitle]="true"
                ></view-value>
                <!-- SUB TITLE -->
                @if (subTitleIndex) {
                <view-value
                    [column]="ngxTable.columns[this.subTitleIndex]"
                    [item]="item"
                    [viewConfig]="viewConfig"
                    [isCard]="true"
                    [isCardSubTitle]="true"
                ></view-value>
                }
            </div>

            <!-- ACTION -->
            @if (hasAction) {
            <view-action
                [actions]="ngxTable.actions || []"
                [item]="item"
                [viewConfig]="viewConfig"
                [isMobile]="true"
            ></view-action>
            }
        </header>

        <!-- CONTENT -->
        @if (hasContent) {
        <content
            [style.border-color]="viewConfig.borderColor"
            [style.color]="colors[dataIndex]"
            [style.backgroundColor]="viewConfig.cardBackgroundColor"
        >
            @for (column of ngxTable.columns; track $index; let columnIndex = $index) {
            <!-- CHECK TITLE AND SUBTITLE -->
            @if (columnIndex !== titleIndex && columnIndex !== subTitleIndex) {
            <div class="item">
                <div class="title">{{ column.title }}:</div>
                <div class="value">
                    <view-value [column]="column" [item]="item" [viewConfig]="viewConfig" [isCard]="true"></view-value>
                </div>
            </div>
            } }

            <!-- DESCRIPTION -->
            @if (descriptions[dataIndex]) {
            <div
                class="description"
                [style.border-color]="viewConfig.borderColor"
                [innerHTML]="descriptions[dataIndex] || '' | ngxHelperMultiLine"
            ></div>
            }
        </content>
        }
    </section>
    }
</div>
